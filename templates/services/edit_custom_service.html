{% extends 'base.html' %}
{% load static %}

{% block title %}Editar Serviço Personalizado - Job Finder{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h3 class="mb-0"><i class="fas fa-edit"></i> Editar Serviço Personalizado</h3>
                </div>
                <div class="card-body">
                    <form method="POST">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="serviceName" class="form-label">Nome do Serviço</label>
                            <input type="text" class="form-control" id="serviceName" name="name" value="{{ custom_service.name }}" required>
                            <div class="form-text">Dê um nome claro e descritivo para o seu serviço</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="serviceDescription" class="form-label">Descrição</label>
                            <textarea class="form-control" id="serviceDescription" name="description" rows="4" required>{{ custom_service.description }}</textarea>
                            <div class="form-text">Inclua informações importantes como materiais usados, garantia, processo de trabalho, etc.</div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="serviceCategory" class="form-label">Categoria</label>
                                <select class="form-select" id="serviceCategory" name="category" required>
                                    <option value="repair" {% if custom_service.category == 'repair' %}selected{% endif %}>Reparo</option>
                                    <option value="assembly" {% if custom_service.category == 'assembly' %}selected{% endif %}>Montagem</option>
                                    <option value="plumbing" {% if custom_service.category == 'plumbing' %}selected{% endif %}>Encanamento</option>
                                    <option value="electrical" {% if custom_service.category == 'electrical' %}selected{% endif %}>Elétrica</option>
                                    <option value="cleaning" {% if custom_service.category == 'cleaning' %}selected{% endif %}>Limpeza</option>
                                    <option value="painting" {% if custom_service.category == 'painting' %}selected{% endif %}>Pintura</option>
                                    <option value="other" {% if custom_service.category == 'other' %}selected{% endif %}>Outros</option>
                                </select>
                                <div class="form-text">Escolha a categoria mais apropriada para o seu serviço</div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="servicePrice" class="form-label">Preço Estimado (R$)</label>
                                <input type="number" class="form-control" id="servicePrice" name="estimated_price" step="0.01" min="0" value="{{ custom_service.estimated_price }}" required>
                                <div class="form-text">Preço médio cobrado por este serviço</div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="serviceDuration" class="form-label">Duração Estimada (horas)</label>
                                <input type="number" class="form-control" id="serviceDuration" name="estimated_duration" min="1" value="{{ custom_service.estimated_duration|date:'G' }}" required>
                                <div class="form-text">Tempo médio necessário para completar este serviço</div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="isActive" class="form-label">Status</label>
                                <select class="form-select" id="isActive" name="is_active">
                                    <option value="true" {% if custom_service.is_active %}selected{% endif %}>Ativo</option>
                                    <option value="false" {% if not custom_service.is_active %}selected{% endif %}>Inativo</option>
                                </select>
                                <div class="form-text">Defina se o serviço está disponível para solicitações</div>
                            </div>
                        </div>
                        
                        <div class="alert alert-info">
                            <h6><i class="fas fa-info-circle"></i> Dicas para otimizar seu serviço</h6>
                            <ul class="mb-0">
                                <li>Mantenha a descrição atualizada com suas habilidades atuais</li>
                                <li>Revise periodicamente o preço para manter a competitividade</li>
                                <li>Ajuste a duração conforme sua experiência aumenta</li>
                                <li>Destaque diferenciais como garantia ou atendimento especial</li>
                            </ul>
                        </div>
                        
                        <div class="d-flex justify-content-between">
                            {% if is_admin %}
                                <a href="{% url 'admin_provider_services' custom_service.provider.id %}" class="btn btn-secondary">
                                    <i class="fas fa-arrow-left"></i> Voltar
                                </a>
                            {% else %}
                                <a href="{% url 'provider_dashboard' %}" class="btn btn-secondary">
                                    <i class="fas fa-arrow-left"></i> Voltar
                                </a>
                            {% endif %}
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Salvar Alterações
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Format currency input
    document.getElementById('servicePrice').addEventListener('input', function(e) {
        let value = e.target.value;
        if (value && !isNaN(value)) {
            e.target.value = parseFloat(value).toFixed(2);
        }
    });
</script>
{% endblock %}